<!-- Filter Section -->
<div class="date-filter">
  <div class="filter_cont">
    <label for="dateFilter">Filter by Date:</label>
    <input type="date" id="dateFilter" [(ngModel)]="selectedDate" />
    <button (click)="filterByDate()">Filter</button>
  </div>

  <div class="download_container">
    <button
      class="download-btn"
      [disabled]="isDownloading"
      (click)="downloadExcel()"
    >
      {{ isDownloading ? 'Downloading...' : 'Download Excel' }}
    </button>
  </div>
</div>


<!-- Table -->
<table border="1">
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Email</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let user of users">
      <td>{{ user._id }}</td>
      <td>{{ user.name }}</td>
      <td>{{ user.email }}</td>
    </tr>
  </tbody>
</table>


<!-- Displaying error if user array is empty -->
<p *ngIf="noUsersFound" class="no-users-msg">
  No users found for the selected date.
</p>



<!-- Pagination -->
<div class="pagination">
  <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
    Prev
  </button>

  <button
    *ngFor="let page of pages"
    [class.active]="page === currentPage"
    (click)="changePage(page)"
    [disabled]="page === -1"
  >
    {{ page === -1 ? '...' : page }}
  </button>

  <button
    (click)="changePage(currentPage + 1)"
    [disabled]="currentPage === totalPages"
  >
    Next
  </button>
</div>
